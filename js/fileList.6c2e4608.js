(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["fileList"],{"0136":function(t,e,n){"use strict";var r=n("1c24"),i=n.n(r);i.a},"1c24":function(t,e,n){},"214f":function(t,e,n){"use strict";var r=n("32e9"),i=n("2aba"),o=n("79e5"),a=n("be13"),c=n("2b4c");t.exports=function(t,e,n){var s=c(t),l=n(a,s,""[t]),u=l[0],f=l[1];o(function(){var e={};return e[s]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,u),r(RegExp.prototype,s,2==e?function(t,e){return f.call(t,this,e)}:function(t){return f.call(t,this)}))}},"28a5":function(t,e,n){n("214f")("split",2,function(t,e,r){"use strict";var i=n("aae3"),o=r,a=[].push,c="split",s="length",l="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[s]||2!="ab"[c](/(?:ab)*/)[s]||4!="."[c](/(.?)(.?)/)[s]||"."[c](/()()/)[s]>1||""[c](/.?/)[s]){var u=void 0===/()??/.exec("")[1];r=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!i(t))return o.call(n,t,e);var r,c,f,h,p,d=[],g=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),m=0,y=void 0===e?4294967295:e>>>0,v=new RegExp(t.source,g+"g");u||(r=new RegExp("^"+v.source+"$(?!\\s)",g));while(c=v.exec(n)){if(f=c.index+c[0][s],f>m&&(d.push(n.slice(m,c.index)),!u&&c[s]>1&&c[0].replace(r,function(){for(p=1;p<arguments[s]-2;p++)void 0===arguments[p]&&(c[p]=void 0)}),c[s]>1&&c.index<n[s]&&a.apply(d,c.slice(1)),h=c[0][s],m=f,d[s]>=y))break;v[l]===c.index&&v[l]++}return m===n[s]?!h&&v.test("")||d.push(""):d.push(n.slice(m)),d[s]>y?d.slice(0,y):d}}else"0"[c](void 0,0)[s]&&(r=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(n,i){var o=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},"96cf":function(t,e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag",l="object"===typeof t,u=e.regeneratorRuntime;if(u)l&&(t.exports=u);else{u=e.regeneratorRuntime=l?t.exports:{},u.wrap=w;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",g={},m={};m[a]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(U([])));v&&v!==r&&i.call(v,a)&&(m=v);var b=k.prototype=L.prototype=Object.create(m);F.prototype=b.constructor=k,k.constructor=F,k[s]=F.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===F||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(b),t},u.awrap=function(t){return{__await:t}},E(C.prototype),C.prototype[c]=function(){return this},u.AsyncIterator=C,u.async=function(t,e,n,r){var i=new C(w(t,e,n,r));return u.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},E(b),b[s]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){while(e.length){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},u.values=U,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return c.type="throw",c.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:U(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),g}}}function w(t,e,n,r){var i=e&&e.prototype instanceof L?e:L,o=Object.create(i.prototype),a=new D(r||[]);return o._invoke=j(t,n,a),o}function x(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}function L(){}function F(){}function k(){}function E(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function C(t){function e(n,r,o,a){var c=x(t[n],t,r);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"===typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(l).then(function(t){s.value=t,o(s)},function(t){return e("throw",t,o,a)})}a(c.arg)}var n;function r(t,r){function i(){return new Promise(function(n,i){e(t,r,n,i)})}return n=n?n.then(i,i):i()}this._invoke=r}function j(t,e,n){var r=f;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw o;return S()}n.method=i,n.arg=o;while(1){var a=n.delegate;if(a){var c=_(a,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var s=x(t,e,n);if("normal"===s.type){if(r=n.done?d:h,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=d,n.method="throw",n.arg=s.arg)}}}function _(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,_(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=x(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,g;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,g):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function U(t){if(t){var e=t[a];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){while(++r<t.length)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:S}}function S(){return{value:n,done:!0}}}(function(){return this||"object"===typeof self&&self}()||Function("return this")())},a5a6:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"file-list"},[n("header",{staticClass:"layout-header"},[n("el-row",{attrs:{type:"flex",justify:"space-between"}},[n("el-col",{attrs:{span:2}},[n("el-button",{staticClass:"back",attrs:{type:"success"},on:{click:function(e){t.goBack(-1)}}},[t._v("返回")])],1),n("el-col",{attrs:{span:2}},[n("el-upload",{attrs:{action:t.uploadUrl+t.name,"before-upload":t.handleBeforeUpload,"show-file-list":!1,"on-success":t.handleSuccessUpload,"on-error":t.handleErrorUpload}},[n("el-button",{attrs:{icon:"ios-cloud-upload-outline",type:"primary"}},[t._v("上传文件")])],1)],1)],1)],1),n("div",{staticClass:"layout-content"},[n("el-row",{staticClass:"layout-list",attrs:{gutter:16}},t._l(t.files.data,function(e,r){return n("el-col",{key:r,attrs:{span:6}},[n("el-card",[n("img",{staticClass:"thumbnail",attrs:{src:t.previewUrl+e.name}}),n("div",{staticClass:"content"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(e.name))])]),n("div",{staticClass:"bottom"},[n("span",{staticClass:"time"},[t._v(t._s(e.create_time))]),n("span",{staticClass:"btns"},[n("el-button",{attrs:{type:"warning",icon:"el-icon-download",size:"mini",circle:""},on:{click:function(n){n.stopPropagation(),t.handleDownloadFile(e)}}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",circle:""},on:{click:function(n){n.stopPropagation(),t.handleEditFile(e)}}}),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(n){n.stopPropagation(),t.handleDeleteFile(e)}}})],1)])])])],1)})),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":t.size,"page-count":t.page,total:t.files.total},on:{"current-change":t.handlePageChange}})],1)],1),n("el-dialog",{attrs:{width:"500px",title:"编辑图片",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{ref:"editForm",attrs:{model:t.editForm,"label-position":"left","label-width":"80px"}},[n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-input",{attrs:{type:"name",placeholder:"请输入名称"},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name",e)},expression:"editForm.name"}})],1),n("el-form-item",{attrs:{label:"类型",prop:"type"}},[n("el-radio-group",{on:{change:t.handleMimeTypeChange},model:{value:t.editForm.type,callback:function(e){t.$set(t.editForm,"type",e)},expression:"editForm.type"}},[n("el-radio",{attrs:{label:"png"}}),n("el-radio",{attrs:{label:"jpg"}}),n("el-radio",{attrs:{label:"jpeg"}}),n("el-radio",{attrs:{label:"gif"}})],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")]),n("el-button",{on:{click:t.handleCancelDialog}},[t._v("取消")])],1)],1)],1)],1)},i=[];n("96cf");function o(t,e,n,r,i,o,a){try{var c=t[o](a),s=c.value}catch(l){return void n(l)}c.done?e(s):Promise.resolve(s).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function c(t){o(a,r,i,c,s,"next",t)}function s(t){o(a,r,i,c,s,"throw",t)}c(void 0)})}}n("28a5"),n("7f7f");var c=n("be94"),s=n("2f62");function l(t,e){var n=document.createElement("a");n.download=t,n.href=URL.createObjectURL(e),n.click(),URL.revokeObjectURL(e)}var u=300,f={data:function(){return{page:1,size:8,loadingText:"",visible:!1,imgName:"",previewUrl:"http://pkoncwilh.bkt.clouddn.com/",uploadUrl:"http://118.24.155.105:4000/api/v1/qiniu/file?bucket=",currentDate:(new Date).toLocaleDateString(),dialogVisible:!1,editForm:{name:"",type:".png"},currentItem:{}}},methods:Object(c["a"])({},Object(s["b"])(["asyncFetchFileList","asyncDeleteFile","asyncUpdateFile","syncCancelRequest","asyncDownloadFile","asyncUpdateMimeType"]),Object(s["d"])(["setBucket"]),{goBack:function(){this.$router.go(-1)},handleBeforeUpload:function(t){var e=/jpe?g|gif|png/,n=e.test(t.type),r=t.size/1024/1024<2;return n?r?!!n&&r:this.$message.error("".concat(t.name,"太大了，请上传不超过2M的文件")):this.$message.error("".concat(t.name,'文件格式错误，仅支持 ".png" ".jpg" ".jpeg" ".gif" 的图片文件'))},handleSuccessUpload:function(t,e){this.$message.success("".concat(e.name,"上传成功")),this.getCurrPageData()},handleErrorUpload:function(t,e){this.$message.error("".concat(e.name,"上传失败，请稍后重试"))},handleDeleteFile:function(t){var e=this;this.$msgbox({type:"warning",title:"提示",message:"此操作将永久删除该文件, 是否继续?",showCancelButton:!0,beforeClose:function(n,r,i){"confirm"===n&&(r.confirmButtonLoading=!0,r.confirmButtonText="删除中...",e.asyncDeleteFile({id:t.id}).then(function(){i(),r.confirmButtonLoading=!1,e.$message({type:"success",message:"删除成功"}),setTimeout(function(){e.getCurrPageData()},u)}).catch(function(){r.confirmButtonLoading=!1,i()})),"cancel"===n&&(r.confirmButtonLoading=!1,i(),e.syncCancelRequest())}})},handleEditFile:function(t){var e=t.mime_type,n=t.name;this.dialogVisible=!0,this.currentItem=t,this.editForm.name=n,this.editForm.type=e?e.split("/")[1]:""},handleMimeTypeChange:function(){var t=a(regeneratorRuntime.mark(function t(e){var n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=this.currentItem.id,r="image/"+e,t.next=4,this.asyncUpdateMimeType({id:n,type:r});case 4:return t.next=6,this.getCurrPageData();case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleDownloadFile:function(t){var e=t.name;this.asyncDownloadFile({name:e}).then(function(t){return l(e,t)})},handlePageChange:function(t){this.page=t,this.getCurrPageData()},handleSubmit:function(){var t=this;this.$refs.editForm.validate(function(e){if(e){console.log(t.editForm.type);var n={name:t.editForm.name,id:t.currentItem.id};t.handleCancelDialog(),t.asyncUpdateFile(n).then(function(){return t.getCurrPageData()})}})},handleCancelDialog:function(){this.dialogVisible=!1,this.$refs.editForm.resetFields()},getCurrPageData:function(){return this.asyncFetchFileList({bucket:this.name,page:this.page,size:this.size})}}),computed:Object(s["c"])(["name","files"]),mounted:function(){this.setBucket({bucket:this.$route.params.bucket}),this.getCurrPageData()}},h=f,p=(n("0136"),n("2877")),d=Object(p["a"])(h,r,i,!1,null,"63699a94",null);d.options.__file="FileList.vue";e["default"]=d.exports},aae3:function(t,e,n){var r=n("d3f4"),i=n("2d95"),o=n("2b4c")("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},be94:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n("ade3");function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){Object(r["a"])(t,e,n[e])})}return t}}}]);
//# sourceMappingURL=fileList.6c2e4608.js.map